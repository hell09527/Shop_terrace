{extend name="adminblue/base" /}
{block name="resources"/}
<link rel="stylesheet" type="text/css" href="ADMIN_CSS/promotion_game.css">
<script src="ADMIN_JS/My97DatePicker/WdatePicker.js" type="text/javascript"></script>
{/block}
{block name="right_tab"}{/block}
{block name="main"}
<div class="div_main" onselectstart="return false">
	<nav class="nav-wrap">
		<ul class="progress-nav progress-nav-4 clearfix">
			<li class="progress-nav-item active current-active" style="cursor: pointer;">创建活动</li>
			<li class="progress-nav-item" style="cursor: pointer;">中奖设置</li>
			<li class="progress-nav-item" style="cursor: pointer;">奖励设置</li>
			<li class="progress-nav-item">完成</li>
		</ul>
	</nav>

	<div class="content_left">
		{$game_type_info.game_text}
	</div>
	
	<div class="content_right">
	
		<div id="game_one" >
			<p class="menu_form_hd">创建活动</p>
			<div class="menu_form_bd">
			
				<!-- 活动名称 -->
				<div class="frm_control_group ">
					<label for="menuname" class="frm_label">
						<strong class="title js_menuTitle">活动名称</strong>
					</label>
					<div class="frm_controls">
						<span class="frm_input_box with_counter counter_in append">
							<input type="text" id="game_name" data-switch="game_name" value="{$game_info.name}" class="frm_input" style="box-shadow: none; padding: 0;"  placeholder="填写活动名称">
						</span>
						<p class="frm_tips js_titleNolTips">字数不超过8个汉字或16个字母</p>
					</div>
				</div>
				
				<!-- 活动开始时间 -->
				<div class="frm_control_group ">
					<label for="menuname" class="frm_label">
						<strong class="title js_menuTitle">开始时间</strong>
					</label>
					<div class="frm_controls">
						<span class="frm_input_box with_counter counter_in append">
							<input type="datetime" id="start_time" data-switch="start_time" value="{:getTimeStampTurnTime($game_info.start_time)}" onclick="WdatePicker({skin:'twoer',dateFmt:'yyyy-MM-dd HH:mm:ss'})" onchange="" class="frm_input" style="box-shadow: none; padding: 0;"  >
						</span>
						<p></p>
					</div>
				</div>
				
				<!-- 活动结束时间 -->
				<div class="frm_control_group ">
					<label for="menuname" class="frm_label">
						<strong class="title js_menuTitle">结束时间</strong>
					</label>
					<div class="frm_controls">
						<span class="frm_input_box with_counter counter_in append">
							<input type="text" id="end_time" data-switch="end_time" value="{:getTimeStampTurnTime($game_info.end_time)}" onclick="WdatePicker({skin:'twoer',dateFmt:'yyyy-MM-dd HH:mm:ss'})" onchange="" class="frm_input" style="box-shadow: none; padding: 0;"  >
						</span>
						<p></p>
					</div>
				</div>
				
				<!-- 活动图片 -->
				<div class="frm_control_group">
					<label for="menuname" class="frm_label">
						<strong class="title js_menuTitle">活动图片</strong>
					</label>
					<div class="frm_controls">
						<div class="class-logo"><p><img id="imgActivity" {if condition="$game_info.activity_images"}src="{:__IMG($game_info.activity_images)}"{/if}></p></div>
						<div class="upload-btn" style="margin: 10px 5px 10px 0;">
							<span>
								<input class="input-file" name="file_upload" id="uploadImg" type="file" onchange="imgUpload(this);">
							</span>
							<p><i class="fa fa-cloud-upload"></i>上传图片</p>
						</div>
						<input type="hidden" id="hidden_activity_image" value="{$game_info.activity_images}">
						<p class="frm_tips js_titleNolTips">上传活动图片后，才会在首页显示</p>
					</div>
				</div>
				
				<!-- 活动说明 -->
				<div class="frm_control_group">
					<label for="menuname" class="frm_label">
						<strong class="title js_menuTitle">活动说明</strong>
					</label>
					<div class="frm_controls">
						<textarea name="remark" id="remark" cols="30" rows="6" class="textarea input-common">{$game_info.remark}</textarea>
					</div>
				</div>
				
			</div>
			
			<p class="menu_form_hd">参与条件</p>
			<div class="menu_form_bd">
			
				<!-- 活动名称 -->
				<div class="frm_control_group ">
					<label for="menuname" class="frm_label">
						<strong class="title js_menuTitle">参与的用户</strong>
					</label>
					<div class="frm_controls">
					
						<select name="member_level" id="member_level" data-switch="member_level" class="frm_input" style="box-shadow: none; padding: 0;">
							<option value="0">全部会员</option>
							{volist name = "level_list" id = "vo"}
								{if condition = "$vo.level_id eq $game_info.member_level"}
									<option value="{$vo.level_id}" selected="selected">{$vo.level_name}</option>
								{else /}
									<option value="{$vo.level_id}">{$vo.level_name}</option>
								{/if}
							{/volist}
						</select>
						<p class="frm_tips js_titleNolTips">默认所有用户都能参与活动</p>
					</div>
				</div>
				
				<!-- 活动开始时间 -->
				<div class="frm_control_group ">
					<label for="menuname" class="frm_label">
						<strong class="title js_menuTitle">消耗积分</strong>
					</label>
					<div class="frm_controls">
						<span class="frm_input_box with_counter counter_in append number">
							<input type="number" id="points" data-switch="points" value="{$game_info.points}" class="frm_input" style="box-shadow: none; padding: 0;"  >
						</span>
						<p class="frm_tips js_titleNolTips">用户每次参与需要消耗积分</p>
					</div>
				</div>
				
				
			</div>
		</div>
				
		<div id="game_two" style="display: none;">
			<p class="menu_form_hd">中奖概率</p>
			<div class="menu_form_bd">
				<div class="frm_control_group ">
					<label for="menuname" class="frm_label">
						<strong class="title js_menuTitle">中奖率</strong>
					</label>
					<div class="frm_controls">
						<span class="frm_input_box with_counter counter_in append number">
							<input type="number" id="winning_rate" value="{$game_info.winning_rate}" data-switch="winning_rate" class="frm_input" style="box-shadow: none; padding: 0;"  >
						</span>%
						<p class="frm_tips js_titleNolTips">会员中奖的总概率</p>
					</div>
				</div>
			</div>
			
			<p class="menu_form_hd">未奖结果说明</p>
	
			<div class="menu_form_bd">
				<div class="frm_control_group ">
					<label for="menuname" class="frm_label">
						<strong class="title js_menuTitle">说明</strong>
					</label>
					<div class="frm_controls">
						<textarea id="no_winning_des" placeholder="哎呀，真可惜你擦身而过" class="textarea input-common">{$game_info.no_winning_des}</textarea>
						<p class="frm_tips js_titleNolTips"></p>
					</div>
				</div>
			</div>
			
		</div>
		
		<div id="game_three" style="display: none;">
			<p class="menu_form_hd">奖励设置</p>
			<p class="frm_tips js_titleNolTips">
				等级设置的奖品数量越多，则该等级中奖率越高。例如：设置一等奖 10个，二等奖20个，则中二等奖概率高于一等奖
			</p>
			<div class="menu_form_bd">
			
				<div class="menu_content">
				<a href="javascript:;" class="add">添加奖品</a>
				
					<table class="game_table">
						<thead>
							<th width="20%">奖励等级</th>
							<th width="20%">奖品类型</th>
							<th width="20%">奖励说明</th>
							<th width="20%">奖品数量（个）</th>
							<th width="20%">操作</th>
						</thead>
						<tbody id="games_rule">
							{volist name = "$game_info.rule" id = "vo"}
								<tr>
									<td name="rule_name">{$vo.rule_name}</td>
									<td name="rule_type_name">
										{if condition = "$vo.type eq 1"}
											赠送积分
										{elseif condition = "$vo.type eq 2" }
											送优惠
										{elseif condition = "$vo.type eq 3" }
											红包
										{elseif condition = "$vo.type eq 4" }
											赠品
										{/if}
										<input type="hidden" name="rule_type" value="{$vo.type}">
									</td>
									<td name="rule_text">{$vo.type_value}
									<input type="hidden" name="rule_value" value="{if condition = "$vo.type eq 1"}{$vo.points}
										{elseif condition = "$vo.type eq 2" }{$vo.coupon_type_id}
										{elseif condition = "$vo.type eq 3" }{$vo.hongbao}
										{elseif condition = "$vo.type eq 4" }{$vo.gift_id}{/if}"/></td>
									
									<td name="rule_num">{$vo.rule_num}</td>
									<td><a href="javascript:;" onclick="setRule(this)">编辑</a>&nbsp;&nbsp;&nbsp;
										<a href="javascript:;" onclick="delRule(this)">删除</a></td>
								</tr>
							{/volist}
						</tbody>
					</table>
					
					<div class="frm_control_group ">
						<label for="menuname" class="frm_label">
							<strong class="title js_menuTitle">奖励等级</strong>
						</label>
						<div class="frm_controls">
							<span class="frm_input_box with_counter counter_in append">
								<input type="text" id="rule_name" data-switch="rule_name" class="frm_input" style="box-shadow: none; padding: 0;"  placeholder="请填写奖励等级">
							</span>
							<span class="red"></span>
							<p class="frm_tips js_titleNolTips">奖励规则等级</p>
						</div>
					</div>
					
					<div class="frm_control_group ">
						<label for="menuname" class="frm_label">
							<strong class="title js_menuTitle">选择奖品</strong>
						</label>
						<div class="frm_controls">
							<label for="rule_type_1">
								<input type="radio" checked="checked" id = "rule_type_1" name = "rule_type" value="1"/>赠送积分
							</label>
							<label for="rule_type_2">
								<input type="radio" id = "rule_type_2"  name = "rule_type" value="2"/>送优惠
							</label>
							<label for="rule_type_3">
								<input type="radio" id = "rule_type_3"  name = "rule_type" value="3"/>红包
							</label>
							<label for="rule_type_4">
								<input type="radio" id = "rule_type_4"  name = "rule_type" value="4"/>赠品
							</label>
							
							<p class="frm_tips js_titleNolTips" style="margin-bottom: -5px;">&nbsp;</p>
						</div>
					</div>
					
					<div class="frm_control_group rule_type">
						<label for="menuname" class="frm_label">
							<strong class="title js_menuTitle">赠送积分</strong>
						</label>
						<div class="frm_controls rule_type">
							<span class="frm_input_box with_counter counter_in append number">
								<input type="number" id="rule_points" data-switch="rule_points" class="frm_input" style="box-shadow: none; padding: 0;"  placeholder="请填写积分数">
							</span>
							<span class="red"></span>
							<p class="frm_tips js_titleNolTips">赠送积分数量</p>
						</div>
					</div>
					
					<div class="frm_control_group rule_type" style="display: none;">
						<label for="menuname" class="frm_label">
							<strong class="title js_menuTitle">优惠劵</strong>
						</label>
						<div class="frm_controls">
							
							<select name="coupon_type_id" id="coupon_type_id">
								<option value="0">请选择优惠劵</option>
								{volist name = "coupon_type_list" id = "vo"}
									<option value="{$vo.coupon_type_id}">{$vo.coupon_name}</option>
								{/volist}
							</select>
							<span class="red"></span>
							<p class="frm_tips js_titleNolTips">选择赠送的优惠劵</p>
						</div>
					</div>
					
					<div class="frm_control_group rule_type" style="display: none;">
						<label for="menuname" class="frm_label">
							<strong class="title js_menuTitle">奖励红包</strong>
						</label>
						<div class="frm_controls">
							<span class="frm_input_box with_counter counter_in append number">
								<input type="number" id="rule_hongbao" data-switch="rule_hongbao" class="frm_input" style="box-shadow: none; padding: 0;"  placeholder="请填写红包数">
							</span>
							<span class="red"></span>
							<p class="frm_tips js_titleNolTips">赠送余额</p>
						</div>
					</div>
					
					<div class="frm_control_group rule_type" style="display: none;">
						<label for="menuname" class="frm_label">
							<strong class="title js_menuTitle">奖励赠品</strong>
						</label>
						<div class="frm_controls">
							<select name="gift_id" id="gift_id">
								<option value="0">请选择赠品</option>
								{volist name = "gift_list" id = "vo"}
									<option value="{$vo.gift_id}">{$vo.gift_name}</option>
								{/volist}
							</select>
							<span class="red"></span>
							<p class="frm_tips js_titleNolTips">奖励的赠品</p>
						</div>
					</div>
					
					<div class="frm_control_group ">
						<label for="menuname" class="frm_label">
							<strong class="title js_menuTitle">奖品数量</strong>
						</label>
						<div class="frm_controls">
							<span class="frm_input_box with_counter counter_in append number">
								<input type="number" id="rule_num" data-switch="rule_num" class="frm_input" style="box-shadow: none; padding: 0;" >
							</span>&nbsp;&nbsp;个
							<span class="red"></span>
							<p class="frm_tips js_titleNolTips">奖品数量不能为0</p>
						</div>
					</div>
					
					<div class="frm_control_group " style = "text-align: center;">
						<a href="javascript:;" class="rule_a">保存</a>
					</div>
				</div>
				
			</div>
		</div>
	</div>

	<div class="bottom_button">
		<a href="javascript:;" class="button_step upper" style="display: none;">上一步</a>
		<a href="javascript:;" class="button_step next">下一步</a>
		<a href="javascript:;" class="complete" style="display: none;">完成</a>
	</div>
</div>
{include file="adminblue/Games/controlPromotionGameJs"}
{/block}
{block name="script"}{/block}